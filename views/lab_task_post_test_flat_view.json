{
  "resourceType": "http://41.59.228.177/datapipes/fhir/uv/sql-on-fhir/StructureDefinition/ViewDefinition",
  "name": "lab_task_post_test_flat",
  "status": "active",
  "resource": "Task",
  "text": "Flat view definition for Task resource.",
  "fhirVersion": ["4.0"],
  "select": [
    {
      "column": [
        {
          "path": "getResourceKey()",
          "name": "id",
          "type": "string"
        },
        {
          "path": "identifier.where(system = 'urn:sys:obr-set-id').value.first()",
          "name": "obr_set_id",
          "type": "string"
        },
        {
          "path": "focus.getReferenceKey(Specimen)",
          "name": "specimen_id",
          "type": "string"
        },
        {
          "path": "status",
          "name": "status",
          "type": "string"
        },
        {
          "path": "intent",
          "name": "intent",
          "type": "string"
        },
        {
          "path": "code.text",
          "name": "code_text",
          "type": "string"
        },
        {
          "path": "authoredOn",
          "name": "authored_on",
          "type": "dateTime"
        },
        {
          "path": "lastModified",
          "name": "last_modified",
          "type": "dateTime"
        },
        {
          "path": "owner.getReferenceKey(Organization)",
          "name": "requesting_facility_id",
          "type": "string"
        },
        {
          "path": "output.where(type.coding.exists(code = 'resultsReceivedAtFacility')).value.ofType(dateTime)",
          "name": "results_received_at_facility",
          "type": "dateTime"
        },
        {
          "path": "output.where(type.coding.exists(code = 'dateTimeResultsprovidedToClient')).value.ofType(dateTime)",
          "name": "results_provided_to_client",
          "type": "dateTime"
        },
        {
          "path": "output.where(type.coding.code = 'resultsReceivedAtFacility').type.coding[0].system",
          "name": "output_received_system",
          "type": "string"
        },
        {
          "path": "output.where(type.coding.code = 'resultsReceivedAtFacility').type.coding[0].display",
          "name": "output_received_display",
          "type": "string"
        },
        {
          "path": "output.where(type.coding.code = 'dateTimeResultsprovidedToClient').type.coding[0].system",
          "name": "output_provided_system",
          "type": "string"
        },
        {
          "path": "output.where(type.coding.code = 'dateTimeResultsprovidedToClient').type.coding[0].display",
          "name": "output_provided_display",
          "type": "string"
        },
        {
          "path": "extension.where(url = 'http://fhir.moh.go.tz/fhir/lab-request/post-lab-test-results/typeOfTest').value.ofType(string)",
          "name": "type_of_test",
          "type": "string"
        }
      ]
    }
  ]
}
